<PAPER>
	<ABSTRACT>
		<S sid ="1" ssid = "1">This paper presents an application of finite- state transducers to the domain of medicine.</S>
		<S sid ="2" ssid = "2">The objective is to assign disease codes to each Diagnostic Term in the medical records generated by the Basque Health Hospital System.</S>
		<S sid ="3" ssid = "3">As a starting point, a set of manually coded medical records were collected in order to code new medical records on the basis of this set of positive samples.</S>
		<S sid ="4" ssid = "4">Since the texts are written in natural language by doctors, the same Diagnostic Term might show alternative forms.</S>
		<S sid ="5" ssid = "5">Hence, trying to code a new medical record by exact matching the samples in the set is not always feasible due to sparsity of data.</S>
		<S sid ="6" ssid = "6">In an attempt to increase the coverage of the data, our work centered on applying a set of finite-state transducers that helped the matching process between the positive samples and a set of new entries.</S>
		<S sid ="7" ssid = "7">That is, these transducers allowed not only exact matching but also approximate matching.</S>
		<S sid ="8" ssid = "8">While there are related works in languages such as English, this work presents the first results on automatic assignment of disease codes to medical records written in Spanish.</S>
	</ABSTRACT>
	<SECTION title="Introduction" number = "1">
			<S sid ="9" ssid = "9">During the last years an exponential increase in the number of electronic documents in the medical domain has occurred.</S>
			<S sid ="10" ssid = "10">The automatic processing of these documents allows to retrieve information, helping the health professionals in their work.</S>
			<S sid ="11" ssid = "11">There are different sort of valuable data that help to exploit medical information.</S>
			<S sid ="12" ssid = "12">Our framework lays on the classification of Medical Records (MRs) according to a standard.</S>
			<S sid ="13" ssid = "13">In our context, the MRs produced in a hospital have to be classified with respect to the World Health Organization’s 9th Revision of the International Classification of Diseases1 (ICD9).</S>
			<S sid ="14" ssid = "14">ICD9 is designed for the classification of morbidity and mortality information and for the indexing of hospital records by disease and procedure.</S>
			<S sid ="15" ssid = "15">The already classified MRs are stored in a database that serves for further classification purposes.</S>
			<S sid ="16" ssid = "16">Each MR consists of two pieces of information: Diagnostic Terms (DTs): one or more terms that describe the diseases corresponding to the MR. Body-text: a description of the patient’s details, antecedents, symptoms, adverse effects, methods of administration of medicines etc. Even though the DTs are within a limited domain, their description is not subject to a standard.</S>
			<S sid ="17" ssid = "17">Doctors express the DTs in natural language with their own style and different degrees of precision.</S>
			<S sid ="18" ssid = "18">Usually, a given concept might be expressed by alternative DTs with variations due to modifiers, abbreviations, acronyms, dates, names, misspellings or style.</S>
			<S sid ="19" ssid = "19">This is a typical problem that arises in natural language processing due to the fact that doctors focus on the patients and not so much on the writing of the MR. On account of this, there is ample variability in the presentation of the DTs.</S>
			<S sid ="20" ssid = "20">Consequently, it is not a straightforward task to get the corresponding ICD- codes.</S>
			<S sid ="21" ssid = "21">That is, the task is by far more complex than a standard dictionary lookup.</S>
			<S sid ="22" ssid = "22">1 http://www.cdc.gov/nchs/icd/icd9.htm The Basque Health Hospital System is concerned with the automatization of this ICD-code assignment task.</S>
			<S sid ="23" ssid = "23">So far, the hospital processes the daily produced documents in the following sequence: 1.</S>
			<S sid ="24" ssid = "24">Automatic: exact match of the DTs in a set of.</S>
			<S sid ="25" ssid = "25">manually coded samples.</S>
	</SECTION>
	<SECTION title="Semi-automatic: through semantic  match,. " number = "2">
			<S sid ="26" ssid = "1">ranking the DTs by means of machine-learning techniques.</S>
			<S sid ="27" ssid = "2">This stage requires that experts select amongst the ranked choices.</S>
	</SECTION>
	<SECTION title="Manual:  the documents that were not matched. " number = "3">
			<S sid ="28" ssid = "1">in the previous two stages are examined by professional coders assigning the codes manually.</S>
			<S sid ="29" ssid = "2">The goal of this paper is to bypass the variability associated to natural language descriptions in an attempt to maximize the proportion of automatically assigned codes, as the Hospital System aims to expand the use of the automatic codification of MRs to more hospitals.</S>
			<S sid ="30" ssid = "3">According to experts, even an increase of 1% in exact match would represent a significant improvement allowing to gain time and resources.</S>
			<S sid ="31" ssid = "4">Related work can be found in the literature.</S>
			<S sid ="32" ssid = "5">For instance, Pestian et al.</S>
			<S sid ="33" ssid = "6">(2007) reported on a shared task involving the assignment of ICD-codes to radiology reports written in English from a reduced set of 45 codes.</S>
			<S sid ="34" ssid = "7">In general it implied the examination of the full MR (including body-text).</S>
			<S sid ="35" ssid = "8">In our case, the number of ICD-codes is above 1,000, although we restrict ourselves to exact and approximate match over the diagnoses.</S>
			<S sid ="36" ssid = "9">Farkas and Szarvas (2008) used machine learning for the automatic assignment of ICD9 codes.</S>
			<S sid ="37" ssid = "10">Their results showed that handcrafted systems could be reproduced by replacing several laborious steps in their construction with machine learning models.</S>
			<S sid ="38" ssid = "11">Tsuruoka et al.</S>
			<S sid ="39" ssid = "12">(2008) presented a system that tried to normalize different variants of the terms contained in a medical dictionary, automatically getting normalizing rules for genes, proteins, chemicals and diseases in English.</S>
			<S sid ="40" ssid = "13">The contribution of this work is: i) to collect manually coded MRs in Spanish; ii) to approximate transduction with finite-state (FS) models for automatic MR coding and, iii) to assess the performance of the proposed FS transduction approaches.</S>
			<S sid ="41" ssid = "14">2 Approximate transduction.</S>
			<S sid ="42" ssid = "15">As it was previously mentioned, there are variations regarding the DT descriptions due to style, miss- spells, etc. Table 1 shows several pairs of DT and ICD-codes within the collected samples that illustrate some of those variations.</S>
			<S sid ="43" ssid = "16">Table 1: Examples of DTs and their ICD-codes.</S>
			<S sid ="44" ssid = "17">There are differences in the use of uppercase/lower case; omissions of accents; use of both standard and nonstandard abbreviations (e.g. ca.</S>
			<S sid ="45" ssid = "18">for both ca´ ncer and adenocarcinoma); punctuation marks (incidental use of full-stop as commas, etc.); omission of prepositions (see rows 1 and 2); equivalence between Roman and Arabic numerals (rows 5 and 6).</S>
			<S sid ="46" ssid = "19">Due to these variations, our problem can be defined as an approximate lookup in a dictionary.</S>
			<S sid ="47" ssid = "20">2.1 Finite-state models.</S>
			<S sid ="48" ssid = "21">Foma toolkit was used to build the FS machines and code the evaluation sets.</S>
			<S sid ="49" ssid = "22">Foma (Hulden, 2009) is a freely available2 toolkit that allows to both build and parse FS automata and transducers.</S>
			<S sid ="50" ssid = "23">Foma offers a versatile layout that supports imports/exports from/to other tools such as: Xerox XFST (Beesley and Karttunen, 2003), AT&amp;T (Mehryar Mohri and Riley, 2003), OpenFST (Riley et al., 2009).</S>
			<S sid ="51" ssid = "24">There are, as well, outstanding alternatives such as HFST (Linde´n et al., 2010).</S>
			<S sid ="52" ssid = "25">Refer to (YliJyra¨ et al., 2006) for a thorough inventory on FS resources.</S>
			<S sid ="53" ssid = "26">The FS models in Figure 1 perform the conversions necessary to carry out a soft match between the dictionary entries and their variants.</S>
			<S sid ="54" ssid = "27">• First, we define the transducer Accents that takes into account the correspondences between standard letters and their versions using accent text marks.</S>
			<S sid ="55" ssid = "28">2 http://code.google.com/p/foma d e f i n e Ac ce nt s [a :´a |e :´e |i:´ ı| o:´ o| u:´ u |.</S>
			<S sid ="56" ssid = "29">]; d e f i n e Ca se [a :A |b :B |c :C |d :D |e :E |f: F| ...</S>
			<S sid ="57" ssid = "30">]; d e f i n e Sp ac es [.</S>
			<S sid ="58" ssid = "31">| &quot;.&quot;] , . # .; d e f i n e P un ct ua tio n [&quot; .&quot; |&quot; &quot;| &quot; &quot;] :[ &quot;.</S>
			<S sid ="59" ssid = "32">&quot;|&quot; &quot;| &quot; &quot;] ; defi ne Plurals [..]</S>
			<S sid ="60" ssid = "33">-&gt; ([s|es]) || [.#.</S>
			<S sid ="61" ssid = "34">| &quot;.&quot; | &quot; &quot;]; d e f i n e Pl ur al sI [s|es ] (-&gt;) &quot;&quot; || [.#.</S>
			<S sid ="62" ssid = "35">| &quot;.&quot; | &quot;,&quot;| &quot; &quot;]; d e f i n e Pr ep s [..]</S>
			<S sid ="63" ssid = "36">(-&gt;) [de |del |con |por ] || &quot; &quot; ; d e f i n e Di se as e [enf|e nf.|en ferme dad]:[ enf|e nf.|en ferme dad]; d e f i n e Alt C a [tumo r|ca|c a.|car cinom a|ade nocar cinom a|c´an cer]; d e f i n e Ta gN or m Ca AltCa :AltC a; d e f i n e Al tIz q [izqui erdo| izqui erda| izq|iz q.|izq da|iz qda.| izqdo |izqd o.|izd a|izd a.|izd o|izd o.]; d e f i n e Ta gN or mI zq AltIz q:AltI zq; Figure 1: A simplified version in Foma source code of the regular expressions and transducers used to bypass several sources of distortion within the DTs in order to parse variations of unseen input DTs.</S>
			<S sid ="64" ssid = "37">• The expression Case matches uppercase and lowercase versions of the DTs.</S>
			<S sid ="65" ssid = "38">• There is a set of transducers (Spaces, Punctuation, Plurals and PluralsI) that deal with the addition or deletion of spaces and separators (as full-stop, comma, and hyphen) between words or at the end of the DT.</S>
			<S sid ="66" ssid = "39">• Prepositions.</S>
			<S sid ="67" ssid = "40">Many DTs can be differentiated by the use or absence of prepositions, although they correspond to the same ICD-code.</S>
			<S sid ="68" ssid = "41">For that reason, we designed a transducer that inserts or deletes the prepositions from a reduced set that were identified by inspection of the training set.</S>
			<S sid ="69" ssid = "42">In this way, expressions as ”Adenocarcinoma prostata” and ”Adenocarcinoma de prostata” can be mapped to each other.</S>
			<S sid ="70" ssid = "43">• Tag Normalization of synonyms, variants and abbreviations.</S>
			<S sid ="71" ssid = "44">The examination of the DTs in the training set revealed that there were several terms used indistinctly, including synonyms and different kinds of variants (masculine and feminine) and abbreviations.</S>
			<S sid ="72" ssid = "45">For example, the words adenocarcinoma, adenoca., carcinoma, ca, ca.</S>
			<S sid ="73" ssid = "46">and cancer serve to name the same disease.</S>
			<S sid ="74" ssid = "47">There are also multiple variants of left/right, indicating the location of an illness, that do not affect the assignment of the ICD-code (e.g. izquierdo, izq., izda.).</S>
			<S sid ="75" ssid = "48">Finally, all the FS transducers were composed into a single machine that served to overcome all the sources of distortion together.</S>
			<S sid ="76" ssid = "49">3 Experimental results.</S>
			<S sid ="77" ssid = "50">To begin with, coded MRs produced in the hospital throughout 12 months were collected summing up a total of 8,020 MRs as described in Table 2.</S>
			<S sid ="78" ssid = "51">Note that there are ambiguities in our data-set since there are 3,313 different DTs that have resulted in 3,407 (DT, ICD-code) different pairs (as shown in Table 2).</S>
			<S sid ="79" ssid = "52">That is, the same DT was not always assigned the same ICD-code.</S>
			<S sid ="80" ssid = "53">Table 2: The data-set of (DT, ICD-code) pairs.</S>
			<S sid ="81" ssid = "54">Next, the data-set was shuffled and divided into 3 disjoint sets for training, development and test purposes as shown in Table 3.</S>
			<S sid ="82" ssid = "55">tr ai n d e v te st e nt ri es 6, 02 0 1, 00 0 1, 00 0 dif fer en t e nt ri es 2, 82 5 7 3 4 7 2 8 Table 3: The data-set shuffled and divided into 3 sets Using the set of mappings derived from the training set we performed the experiments on the development set.</S>
			<S sid ="83" ssid = "56">After several rounds of tuning the system, the resulting system was applied to the test set.</S>
			<S sid ="84" ssid = "57">PERC ENTA GE OF UNCL ASSIF IED DTs T R AI N E V AL S E T ex act m at ch + ca se in s. + p u n ct . + pl ur al s + pr ep s. + tag n or m . tr ai n d ev 3 0 . 6 2 7 . 0 2 5 . 2 2 4 . 4 2 3 . 9 2 3 . 2 tr ai n te st 2 9 . 8 2 6 . 7 2 5 . 1 2 4 . 8 2 4 . 3 2 3 . 2 tr ai n + d ev te st 2 7 . 7 2 4 . 5 2 3 . 0 2 2 . 9 2 2 . 5 2 1 . 4 Table 4: Performance of different FS machines in terms of the percentage of unclassified entries.</S>
			<S sid ="85" ssid = "58">All the classified entries were correctly classified, yielding, as a result, a precision of 100%.</S>
			<S sid ="86" ssid = "59">Given a DT, the goal is to find its corresponding ICD-code despite the variations.</S>
			<S sid ="87" ssid = "60">Different FS approaches (described in Section 2.1) were proposed to bypass particular sources of noise in the DT.</S>
			<S sid ="88" ssid = "61">Their performance was assessed by means of the percentage of unclassified DTs, as summarized in Table 4.</S>
			<S sid ="89" ssid = "62">Note that the lower the number of unclassified DTs the better the performance.</S>
			<S sid ="90" ssid = "63">In each of the three rows of Table 4 the results of different experimental setups are shown: in the first two rows the training set was used to build the models and either the development or the test set was evaluated in their turn; in the third row, both the training and the development sets were used to build the model and the test set was evaluated.</S>
			<S sid ="91" ssid = "64">The impact of adding progressively the FS machines built to tackle particular sources of noise is shown by columns.</S>
			<S sid ="92" ssid = "65">Thus, the results of the last column represent the performance of the transducer allowing exact-match search together with case-insensitive search, bypassing punctuation marks, allowing plurals, bypassing prepositions and allowing tag-normalization.</S>
			<S sid ="93" ssid = "66">The composition of each transducer outperforms the previous result, yielding an improvement on the test of 6 absolute points over the exact-match baseline, from 27.7% to 21.4%.</S>
			<S sid ="94" ssid = "67">As it can be derived from the first column of Table 4 the test set contributed to the training+development set with %27.7 of new DTs.</S>
			<S sid ="95" ssid = "68">Overall, the FSMs progressively improved the results for the three series of experiments carried out in more than 6%.</S>
			<S sid ="96" ssid = "69">As a result, less and less DTs are left unclassified.</S>
			<S sid ="97" ssid = "70">In other words, the FS machines tackling different sources of errors contribute to assign ICD-codes to previously unassigned DTs.</S>
			<S sid ="98" ssid = "71">A manual inspection over the results associated to the evaluation of the development set (focus on the first row of Table 4) showed that all the DTs were correctly classified according to the training data.</S>
			<S sid ="99" ssid = "72">Overall, the resulting transducer was unable to classify 232 DTs out of 1,000 (see last column in first row).</S>
			<S sid ="100" ssid = "73">Among the unclassified DTs, 10 out of 232 were due to misspellings: e.g. cic atriz (instead of cicatriz), desprendimineot (instead of desprendimiento).</S>
			<S sid ="101" ssid = "74">In fact, spelling correction reported improvements in related tasks (Patrick et al., 2010).</S>
			<S sid ="102" ssid = "75">The remaining DTs showed wider variations in their forms, as unexpected degree of specificity (e.g. named entities), spurious dates or numbers.</S>
			<S sid ="103" ssid = "76">4 Conclusions Medical records in Spanish were collected yielding a data set of 8,020 DT and ICD-code pairs.</S>
			<S sid ="104" ssid = "77">While there are a number of references dealing with English medical records, there are few for Spanish.</S>
			<S sid ="105" ssid = "78">The goal of this work was to build a system that given a DT it would find its corresponding ICD- code as in a standard key-value dictionary.</S>
			<S sid ="106" ssid = "79">Yet, the DTs are far from being standard since they contain a number of variations.</S>
			<S sid ="107" ssid = "80">We proposed the use of several FS models to bypass different variants and allow to provide ICD-codes even when the exact DT was not found.</S>
			<S sid ="108" ssid = "81">Each source of variations was tackled with a specific transducer based on handwritten rules.</S>
			<S sid ="109" ssid = "82">The composition of each machine improved the performance of the system gradually, leading to an improvement up to 6% in accuracy, from 27.7% unclassified DTs with the exact-match baseline to 21.4% with the tag-normalization transducer.</S>
			<S sid ="110" ssid = "83">Future work will focus on the unclassified DTs.</S>
			<S sid ="111" ssid = "84">Together with FS models, other strategies shall be explored.</S>
			<S sid ="112" ssid = "85">Machine-learning strategies in the field of information retrieval might help to make the most of the piece of information that was here discarded (i.e. the body-text).</S>
			<S sid ="113" ssid = "86">All in all, regardless of the approach, the command in this MR classification context is to get an accuracy of 100%, possibly through the interactive inference framework (Toselli et al., 2011).</S>
	</SECTION>
	<SECTION title="Acknowledgments">
			<S sid ="114" ssid = "87">Authors would like to thank the Hospital GaldakaoUsansolo for their contributions and support, in particular to Javier Yetano, responsible of the Clinical Documentation Service.</S>
			<S sid ="115" ssid = "88">This research was supported by the Department of Industry of the Basque Government (IT34410, S- PE11UN114, GIC10/158 IT37510), the University of the Basque Country (GIU09/19) and the Spanish Ministry of Science and Innovation (MICINN, TIN201020218).</S>
	</SECTION>
</PAPER>
